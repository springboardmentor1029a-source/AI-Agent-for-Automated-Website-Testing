<!DOCTYPE html>
<html>
<head>
  <title>Test Reports</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<header class="navbar">
  <div class="logo">Reports</div>
  <nav>
    <a href="index.html">Home</a>
    <a href="dashboard.html">Dashboard</a>
  </nav>
</header>

<main class="main">
  <section class="card">
    <h2>Generated Test Reports</h2>

    <table id="reportTable" border="0" width="100%">
      <thead>
        <tr>
          <th align="left">Report File</th>
          <th align="left">Action</th>
        </tr>
      </thead>
      <tbody id="reportBody">
        <tr><td colspan="2">Loading reportsâ€¦</td></tr>
      </tbody>
    </table>
  </section>
</main>

<script>
const BACKEND_URL = "http://127.0.0.1:5000";

fetch(`${BACKEND_URL}/reports-list`)
  .then(res => res.json())
  .then(files => {
    const body = document.getElementById("reportBody");
    body.innerHTML = "";

    if (files.length === 0) {
      body.innerHTML =
        "<tr><td colspan='2'>No reports available</td></tr>";
      return;
    }

    files.forEach(file => {
      body.innerHTML += `
        <tr>
          <td>${file}</td>
          <td>
            <a href="${BACKEND_URL}/reports/${file}" download>
              Download
            </a>
          </td>
        </tr>`;
    });
  })
  .catch(() => {
    document.getElementById("reportBody").innerHTML =
      "<tr><td colspan='2'>Failed to load reports</td></tr>";
  });
</script>

</body>
</html>
